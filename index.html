```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üëÄ„Åø„Å¶„Å§„Åè„Çã„Ç∑„Éº„Éàüöó</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --accent-color: #FF9800;
            --danger-color: #f44336;
            --bg-color: #f8f9fa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: var(--bg-color);
            color: #333;
            line-height: 1.6;
            padding-bottom: 50px;
        }

        /* „Éò„ÉÉ„ÉÄ„Éº */
        .header {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            text-align: center;
            padding: 1.5rem 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 { font-size: 1.8rem; margin-bottom: 5px; }

        /* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
        .nav-container {
            position: sticky;
            top: 0;
            z-index: 100;
            background: white;
            padding: 12px 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .nav-scroll { display: flex; gap: 10px; }

        .nav-btn {
            flex: 0 0 auto;
            padding: 12px 18px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 15px;
            background: #e3f2fd;
            color: #1976D2;
            min-width: 100px;
            cursor: pointer;
        }

        .nav-btn.active {
            background: var(--accent-color);
            color: white;
        }

        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ */
        .main-content {
            padding: 15px;
            max-width: 800px;
            margin: 0 auto;
        }

        .step-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .step-card.danger { border: 4px solid var(--danger-color); }
        .step-card.final { background: #fffde7; border: 4px solid #fdd835; }

        .step-title {
            font-size: 1.6rem;
            color: #1565C0;
            margin-bottom: 15px;
            font-weight: 900;
        }

        .photo-area {
            position: relative;
            margin-bottom: 15px;
            background: #eee;
            border-radius: 12px;
            overflow: hidden;
            touch-action: manipulation;
        }

        .step-img {
            width: 100%;
            display: block;
            border-radius: 12px;
        }

        .zoom-label {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.6);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .info-box {
            padding: 15px;
            border-radius: 12px;
            margin-top: 10px;
            font-size: 1.2rem;
        }
        .ok-box { background: #e8f5e9; color: #2e7d32; font-weight: bold; }
        .note-box { background: #fff3e0; color: #e65100; margin-top: 10px; }

        /* „Ç¢„É´„Éê„É† */
        .add-photo-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 20px;
            border-radius: 15px;
            width: 100%;
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 20px;
            cursor: pointer;
        }

        .album-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .album-item {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
        }

        .album-img-wrap {
            aspect-ratio: 1;
            overflow: hidden;
            background: #000;
        }

        .album-img-wrap img { width: 100%; height: 100%; object-fit: cover; }

        .album-info { padding: 10px; }
        .album-name { display: block; font-weight: bold; font-size: 1.1rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .album-date { font-size: 0.8rem; color: #666; }

        .del-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 20px;
            z-index: 5;
        }

        /* Êã°Â§ß„Ç™„Éº„Éê„Éº„É¨„Ç§ */
        #overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #000;
            z-index: 9999;
            display: none;
            touch-action: none;
            overflow: hidden;
        }

        #overlay-img {
            position: absolute;
            user-select: none;
            will-change: transform;
        }

        #close-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.9);
            border: none;
            border-radius: 50%;
            font-size: 1.2rem;
            font-weight: bold;
            z-index: 10000;
            color: black;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>

<header class="header">
    <h1>üëÄ„Åø„Å¶„Å§„Åè„Çã„Ç∑„Éº„Éàüöó</h1>
    <p>„Åã„Çì„Åü„Çì„Éª„Åü„ÅÆ„Åó„ÅÑÂ∑•‰Ωú„Ç¢„É´„Éê„É†</p>
</header>

<div class="nav-container">
    <div class="nav-scroll" id="navScroll"></div>
</div>

<main class="main-content" id="mainContent"></main>

<div id="overlay">
    <button id="close-btn">„Å®„Åò„Çã<br>√ó</button>
    <img id="overlay-img" src="" alt="Êã°Â§ß">
</div>

<script>
const steps = [
    { nav:"‚ë† „Åß„Çì„Å°", title:"‚ë† „Åß„Çì„Å°ÔºàBOXÔºâ", img1:"images/battery_box.jpg", ok:"ÈõªÊ±†„ÅÆÂêë„ÅçOKÔºÅ", note:"Ôºã„Å®Ôºç„ÇíÁ¢∫Ë™ç„Åó„Åæ„Åô„ÄÇ" },
    { nav:"‚ë° „Åõ„Çì", title:"‚ë° ÈõªÊ±†„Å´„Å§„Åë„ÇãÈõªÁ∑ö", img1:"images/wire_magnet.jpg", ok:"Á∑ö„Åå„Å§„Å™„Åå„Å£„ÅüÔºÅ", note:"Á£ÅÁü≥„Åå„Åó„Å£„Åã„Çä‰ªò„ÅÑ„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„ÄÇ" },
    { nav:"‚ë¢ „Çπ„Ç§„ÉÉ„ÉÅ", title:"‚ë¢ ÂâçÂæåÂàá„ÇäÊõø„Åà„Çπ„Ç§„ÉÉ„ÉÅ", img1:"images/switch_complete.jpg", ok:"ÂâçÂæå„ÅåÂàá„ÇäÊõø„Çè„ÇãÔºÅ", note:"Â∑¶Âè≥SW„ÇíÊäº„Åó„Å¶Âàá„ÇäÊõø„Çè„Çã„ÅãÁ¢∫Ë™ç„ÄÇ" },
    { nav:"‚ë£ „Åæ„Çè„Çã", title:"‚ë£ „É¢„Éº„Çø„Éº„ÅØÂõû„ÇãÔºü", img1:"images/motor_test.jpg", ok:"Âõû„Çå„Å∞ OK", note:"Êåá„ÇíËøë„Å•„Åë„Å™„ÅÑ„Çà„ÅÜÊ≥®ÊÑè„ÄÇ" },
    { nav:"‚ë§ „Åø„Åü„ÇÅ", title:"‚ë§ Ë¶ã„ÅüÁõÆÂÆåÊàêÔºàÂÆüÈ®ì‰∏≠Ôºâ", img1:"images/car_complete.jpg", ok:"„Å§„Å™„ÅéÊñπ„Çí„Åü„ÇÅ„Åù„ÅÜÔºÅ", note:"ÂâçÂæå„ÅåÈÄÜ„Å™„ÇâÂÖ•„ÇåÊõø„Åà„Å¶„Åø„Çà„ÅÜ„ÄÇ", danger:true },
    { nav:"‚ë• „Åã„Çì„Åõ„ÅÑ", title:"‚ë• „Åª„Çì„Å®„ÅÜ„ÅÆÂÆåÊàêÔºÅ", img1:"images/complete.jpg", ok:"ÂâçÂæå„Å´Âãï„ÅÑ„Åü„ÇâÂ§ßÊàêÂäüÔºÅ", note:"ÂÆâÂÖ®„Å´Ëµ∞„Çâ„Åõ„Çà„ÅÜ„ÄÇ", final:true },
    { nav:"üì∏„Ç¢„É´„Éê„É†", title:"üì∏ „Åä„ÇÇ„ÅÑ„Åß„Ç¢„É´„Éê„É†", isAlbum:true }
];

let currentStep = 0;
const navScroll = document.getElementById('navScroll');
const mainContent = document.getElementById('mainContent');

// --- „Ç¢„É´„Éê„É†Âá¶ÁêÜ ---
function getAlbum() { return JSON.parse(localStorage.getItem('myAlbumV3') || '[]'); }
function saveToAlbum(item) {
    const album = getAlbum();
    album.push(item);
    localStorage.setItem('myAlbumV3', JSON.stringify(album));
}
function deleteFromAlbum(ts) {
    if(!confirm("„Åì„ÅÆÂÜôÁúü„ÇíÊ∂à„Åó„Å¶„ÇÇ„ÅÑ„ÅÑ„Åß„Åô„ÅãÔºü")) return;
    const album = getAlbum().filter(i => i.timestamp !== ts);
    localStorage.setItem('myAlbumV3', JSON.stringify(album));
    render();
}

// --- ÊèèÁîªÂá¶ÁêÜ ---
function render() {
    navScroll.innerHTML = '';
    steps.forEach((s, i) => {
        const btn = document.createElement('button');
        btn.className = `nav-btn ${i === currentStep ? 'active' : ''}`;
        btn.textContent = s.nav;
        btn.onclick = () => { currentStep = i; render(); window.scrollTo(0,0); };
        navScroll.appendChild(btn);
    });

    const s = steps[currentStep];
    if (s.isAlbum) {
        renderAlbum(s);
    } else {
        renderStep(s);
    }
}

function renderStep(s) {
    mainContent.innerHTML = `
        <div class="step-card ${s.danger?'danger':''} ${s.final?'final':''}">
            <div class="step-title">${s.title}</div>
            <div class="photo-area" onclick="openZoom('${s.img1}')">
                <img src="${s.img1}" class="step-img">
                <div class="zoom-label">üîç „Çø„ÉÉ„Éó„ÅßÊã°Â§ß</div>
            </div>
            <div class="info-box ok-box">‚úÖ ${s.ok}</div>
            <div class="info-box note-box">üí° ${s.note}</div>
        </div>
    `;
}

function renderAlbum(s) {
    const album = getAlbum().sort((a,b) => b.timestamp - a.timestamp);
    let itemsHtml = album.map(item => `
        <div class="album-item">
            <button class="del-btn" onclick="deleteFromAlbum(${item.timestamp})">√ó</button>
            <div class="album-img-wrap" onclick="openZoom('${item.data}')">
                <img src="${item.data}">
            </div>
            <div class="album-info">
                <span class="album-name">${item.name}</span>
                <span class="album-date">${new Date(item.timestamp).toLocaleString('ja-JP')}</span>
            </div>
        </div>
    `).join('');

    mainContent.innerHTML = `
        <div class="step-card">
            <div class="step-title">${s.title}</div>
            <button class="add-photo-btn" onclick="triggerUpload()">üì∑ ÂÜôÁúü„Çí„Å®„Çã„Éª„Åà„Çâ„Å∂</button>
            <input type="file" id="fileInput" accept="image/*" capture="environment" style="display:none" onchange="handleFile(event)">
            <div class="album-grid">${itemsHtml}</div>
        </div>
    `;
}

function triggerUpload() { document.getElementById('fileInput').click(); }

function handleFile(e) {
    const file = e.target.files[0];
    if(!file) return;
    const name = prompt("Â∑•‰Ωú„ÅÆ„Äå„Å™„Åæ„Åà„Äç„ÇíÊïô„Åà„Å¶„Å≠ÔºÅ", "„Åò„Å∂„Çì„ÅÆÂ∑•‰Ωú");
    if(!name) return;

    const reader = new FileReader();
    reader.onload = (ev) => {
        saveToAlbum({ data: ev.target.result, name: name, timestamp: Date.now() });
        render();
    };
    reader.readAsDataURL(file);
}

// --- Êã°Â§ß„Éª„Ç∫„Éº„É†„Ç®„É≥„Ç∏„É≥ ---
const overlay = document.getElementById('overlay');
const zoomImg = document.getElementById('overlay-img');
let scale = 1, translateX = 0, translateY = 0;
let pointers = {};

function openZoom(src) {
    zoomImg.src = src;
    overlay.style.display = 'block';
    resetZoom();
    
    // ÂàùÊúüÈÖçÁΩÆÂæÖÊ©ü
    setTimeout(() => {
        const isMobile = window.innerWidth < window.innerHeight;
        const rect = zoomImg.getBoundingClientRect();
        // „Çπ„Éû„Éõ„Å™„ÇâÂõûËª¢ËÄÉÊÖÆ
    }, 50);
}

function resetZoom() {
    scale = 1; translateX = 0; translateY = 0;
    updateTransform();
}

function updateTransform() {
    const isMobile = window.innerWidth < window.innerHeight;
    let transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
    if (isMobile) {
        transform += ` rotate(90deg)`;
        // „Çπ„Éû„ÉõÊ®™Âêë„ÅçË°®Á§∫Áî®„Å´„Çµ„Ç§„Ç∫Ë™øÊï¥
        zoomImg.style.width = '100vh';
        zoomImg.style.height = '100vw';
    } else {
        zoomImg.style.width = 'auto';
        zoomImg.style.height = 'auto';
        zoomImg.style.maxWidth = '90%';
        zoomImg.style.maxHeight = '90%';
    }
    zoomImg.style.transform = transform;
    zoomImg.style.left = '50%';
    zoomImg.style.top = '50%';
    zoomImg.style.marginLeft = `-${zoomImg.offsetWidth/2}px`;
    zoomImg.style.marginTop = `-${zoomImg.offsetHeight/2}px`;
}

function closeZoom() {
    overlay.style.display = 'none';
    pointers = {};
}

// „Ç§„Éô„É≥„ÉàÂá¶ÁêÜ
overlay.addEventListener('pointerdown', (e) => {
    if(e.target === zoomImg) e.stopPropagation();
    pointers[e.pointerId] = e;
});

overlay.addEventListener('pointermove', (e) => {
    if (!pointers[e.pointerId]) return;
    if(e.target === zoomImg) e.stopPropagation();

    const prevPointers = Object.values(pointers);
    pointers[e.pointerId] = e;
    const currPointers = Object.values(pointers);

    if (currPointers.length === 2) {
        // „Éî„É≥„ÉÅ„Ç∫„Éº„É†
        const p1 = currPointers[0], p2 = currPointers[1];
        const prev1 = prevPointers.find(p => p.pointerId === p1.pointerId);
        const prev2 = prevPointers.find(p => p.pointerId === p2.pointerId);
        if(prev1 && prev2) {
            const dist1 = Math.hypot(p1.clientX - p2.clientX, p1.clientY - p2.clientY);
            const dist2 = Math.hypot(prev1.clientX - prev2.clientX, prev1.clientY - prev2.clientY);
            const delta = dist1 / dist2;
            scale = Math.min(Math.max(1, scale * delta), 5);
        }
    } else if (currPointers.length === 1 && scale > 1.01) {
        // „Éâ„É©„ÉÉ„Ç∞
        translateX += e.clientX - prevPointers[0].clientX;
        translateY += e.clientY - prevPointers[0].clientY;
    }
    updateTransform();
});

const endHandler = (e) => { delete pointers[e.pointerId]; };
overlay.addEventListener('pointerup', endHandler);
overlay.addEventListener('pointercancel', endHandler);

document.getElementById('close-btn').onclick = (e) => { e.stopPropagation(); closeZoom(); };
overlay.onclick = (e) => { if(e.target === overlay) closeZoom(); };

window.onload = render;
window.onresize = updateTransform;
</script>

</body>
</html>

```
